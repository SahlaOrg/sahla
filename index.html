<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storage Operations Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1, h2 { color: #333; }
        input, button { margin: 10px 0; }
        #fileList, #result { border: 1px solid #ddd; padding: 10px; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Storage Operations Test</h1>

    <h2>Upload File</h2>
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload</button>

    <h2>List Files</h2>
    <button onclick="listFiles()">List Files</button>
    <div id="fileList"></div>

    <h2>File Operations</h2>
    <input type="text" id="filename" placeholder="Enter filename">
    <button onclick="downloadFile()">Download</button>
    <button onclick="getFileInfo()">Get Info</button>
    <button onclick="checkFileExists()">Check Exists</button>
    <button onclick="deleteFile()">Delete</button>

    <h2>Result</h2>
    <div id="result"></div>

    <script>
        const API_URL = 'http://localhost:8080'; // Change this to your API URL

        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (!file) {
                alert('Please select a file');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch(`${API_URL}/upload`, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                document.getElementById('result').innerText = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('result').innerText = 'Error: ' + error.message;
            }
        }

        async function downloadFile() {
            const filename = document.getElementById('filename').value;
            if (!filename) {
                alert('Please enter a filename');
                return;
            }

            window.open(`${API_URL}/download/${filename}`);
        }

        async function listFiles() {
    try {
        const response = await fetch(`${API_URL}/files`);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const files = await response.json();
        document.getElementById('fileList').innerHTML = files.map(file => 
            `<div>${file.Name} (${file.Size} bytes, ${file.LastModified})</div>`
        ).join('');
    } catch (error) {
        document.getElementById('fileList').innerText = 'Error: ' + error.message;
    }
}

async function deleteFile() {
    const filename = document.getElementById('filename').value;
    if (!filename) {
        alert('Please enter a filename');
        return;
    }

    try {
        const response = await fetch(`${API_URL}/files/${encodeURIComponent(filename)}`, {
            method: 'DELETE'
        });
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const result = await response.json();
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    } catch (error) {
        document.getElementById('result').innerText = 'Error: ' + error.message;
    }
}

async function getFileInfo() {
    const filename = document.getElementById('filename').value;
    if (!filename) {
        alert('Please enter a filename');
        return;
    }

    try {
        const response = await fetch(`${API_URL}/files/${encodeURIComponent(filename)}/info`);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const result = await response.json();
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    } catch (error) {
        document.getElementById('result').innerText = 'Error: ' + error.message;
    }
}

async function checkFileExists() {
    const filename = document.getElementById('filename').value;
    if (!filename) {
        alert('Please enter a filename');
        return;
    }

    try {
        const response = await fetch(`${API_URL}/files/${encodeURIComponent(filename)}/exists`);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const result = await response.json();
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    } catch (error) {
        document.getElementById('result').innerText = 'Error: ' + error.message;
    }
}    </script>
</body>
</html>